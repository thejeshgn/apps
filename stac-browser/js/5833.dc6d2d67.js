"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[5833],{75833:function(t,e,n){n.d(e,{STAC:function(){return M},default:function(){return nt}});var r=n(71321);function s(t){return"string"===typeof t&&t.length>0}function i(t){return"object"===typeof t&&t===Object(t)&&!Array.isArray(t)}function l(...t){if(t=t.filter((t=>Array.isArray(t))),t.length>1){let e=Math.max(...t.map((t=>t.length))),n=[];for(let r=0;r<e;r++)n.push(Object.assign({},...t.map((t=>t[r]))));return n}return 1===t.length?t[0]:[]}function a(t){switch(t){case"int8":return-128;case"int16":return-32768;case"int32":return-2147483648}return t.startsWith("u")?0:null}function u(t){switch(t){case"int8":return 127;case"uint8":return 255;case"int16":return 32767;case"uint16":return 65535;case"int32":return 2147483647;case"uint32":return 4294967295}return null}class o{constructor(t,e={},n=[]){if(!i(t))throw new Error("Given data is not an object");if(t instanceof o){for(let e of n)this[e]=t[e];t=t.toJSON()}this._keyMap=e,this._privateKeys=["_keyMap","_privateKeys"].concat(n);for(let r in t)"undefined"===typeof this[r]&&(this[r]=r in e?e[r](t[r],this):t[r])}isItem(){return"Feature"===this.type}isCatalog(){return"Catalog"===this.type}isCatalogLike(){return this.isCatalog()||this.isCollection()}isCollection(){return"Collection"===this.type}isItemCollection(){return"FeatureCollection"===this.type}isCollectionCollection(){return!1}isAsset(){return!1}isLink(){return!1}getObjectType(){}getAbsoluteUrl(){return null}getMetadata(t){return this[t]}toGeoJSON(){return null}getBoundingBox(){return null}getBoundingBoxes(){return[]}toJSON(){let t={};return Object.keys(this).forEach((e=>{if("function"===typeof this[e]||this._privateKeys.includes(e))return;let n=this[e];if(e in this._keyMap){let t=Array.isArray(n)?[]:{};for(let e in n)t[e]=n[e].toJSON();n=t}t[e]=n})),t}}var h=o,c=n(84193);const g=["http","https"];function m(t){return"string"===typeof t&&t.startsWith("/vsi")&&!t.startsWith("/vsicurl/")}function f(t,e,n=!0){return p(t,e,!1,n)}function p(t,e=null,n=!1,r=!0){"string"===typeof t&&t.startsWith("/vsicurl/")&&(t=t.replace(/^\/vsicurl\//,""));let s=c(t);if(e&&s.is("relative")&&!m(t)){let t=c(e),n=t.path();n.endsWith("/")||n.endsWith(".json")||t.path(n+"/"),s=s.absoluteTo(t)}return s.normalize(),n&&(s.query(""),s.fragment("")),r?s.toString():s}const d="application/geo+json",y=["application/json",d,"text/json"],x=["image/gif","image/jpeg","image/apng","image/png","image/webp"],A=["image/tiff; application=geotiff; profile=cloud-optimized","image/vnd.stac.geotiff; cloud-optimized=true"],b=["application/geotiff","image/tiff; application=geotiff","image/vnd.stac.geotiff"].concat(A);x.concat(b);function B(t,e,n=!1){return Array.isArray(e)||(e=[e]),!(!n||"undefined"!==typeof t)||"string"===typeof t&&(e=e.map((t=>t.toLowerCase())),e.includes(t.toLowerCase()))}function k(t,e=!1){return B(t,y,e)}class T extends h{constructor(t,e=null,n={},r=[]){super(t,n,["_context"].concat(r)),this._context||(this._context=e)}getAbsoluteUrl(t=!0){return this._context?f(this.href,this._context.getAbsoluteUrl(),t):this.href.includes("://")?this.href:null}getContext(){return this._context}canBrowserDisplayImage(t=!1){if("string"!==typeof this.href)return!1;if(!t&&"undefined"===typeof this.type)return!1;let e=new c(this.href),n=e.protocol().toLowerCase(),r=e.suffix().toLowerCase();return!(s(n)&&!g.includes(n))&&(!(!s(this.type)||!x.includes(this.type.toLowerCase()))||!("undefined"!==typeof this.type||!s(r)||"jpg"!==r&&!x.includes("image/"+r)))}isType(t){return s(this.type)&&B(this.type,t)}isGeoTIFF(){return this.isType(b)}isCOG(){return this.isType(A)}isHTTP(){let t=this.getAbsoluteUrl(!1),e=t.protocol().toLowerCase();return s(e)&&g.includes(e)}}var v=T;class w extends v{constructor(t,e=null){super(t,e)}isLink(){return!0}getObjectType(){return"Link"}static fromLinks(t,e=null){return Array.isArray(t)?t.map((t=>i(t)?new w(t,e):t)):[]}}var _=w;class L extends h{constructor(t,e=null,n={},r=[]){if(super(t,Object.assign({links:_.fromLinks},n),["_url"].concat(r)),!this._url&&(this._url=e,!this._url)){let t=this.getSelfLink();t&&(this._url=t.href)}}getAbsoluteUrl(){return this._url}setAbsoluteUrl(t){this._url=t}getStacLinksWithRel(t,e=!0){return this.getLinksWithRels([t]).filter((t=>k(t.type,e)))}getStacLinkWithRel(t,e=!0){const n=this.getStacLinksWithRel(t,e);return n.length>0?n[0]:null}getLinks(){return Array.isArray(this.links)?this.links.filter((t=>i(t)&&s(t.href))):[]}getLinkWithRel(t){return this.getLinks().find((e=>e.rel===t))||null}getLinksWithRels(t){return this.getLinks().filter((e=>t.includes(e.rel)))}getLinksWithOtherRels(t){return this.getLinks().filter((e=>!t.includes(e.rel)))}getSelfLink(){return this.getStacLinkWithRel("self")}getRootLink(){return this.getStacLinkWithRel("root")}getParentLink(){return this.getStacLinkWithRel("parent")}}var C=L;class O extends C{constructor(t,e=null,n={},r=[]){super(t,e,n,r)}getAll(){return[]}}var S=O;class R extends v{constructor(t,e=null,n=null){super(t,n,{},["_key"]),this._key||(this._key=e)}getObjectType(){return"Asset"}isAsset(){return!0}getAbsoluteUrl(t=!0){return this.isDefintion()?null:super.getAbsoluteUrl(t)}getKey(){return this._key}getMetadata(t){return"undefined"!==typeof this[t]?this[t]:this._context?this._context.getMetadata(t):void 0}getBands(){return l(this["eo:bands"],this["raster:bands"])}findVisualBands(){let t={red:null,green:null,blue:null},e=this.getBands();for(let r in e){let n=parseInt(r,10),l=e[n];i(l)&&s(l.common_name)&&l.common_name in t&&(t[l.common_name]={index:n,band:l})}let n=Object.values(t).every((t=>null!==t));return n?t:null}findBand(t,e="name",n=null){Array.isArray(t)||(t=[t]),i(n)||(n=this.getBands());let r=n.findIndex((n=>i(n)&&t.includes(n[e])));return r>=0?{index:r,band:n[r]}:null}getBand(t){if(i(t)||null===t)return t;let e=this.getBands();return e[t]||null}getMinMaxValues(t=null){t=this.getBand(t);const e={minimum:null,maximum:null},n=t=>null!==t.minimum&&null!==t.maximum;if(t){if(i(t.statistics)&&("number"===typeof t.statistics.minimum&&(e.minimum=t.statistics.minimum),"number"===typeof t.statistics.maximum&&(e.maximum=t.statistics.maximum),n(e)))return e;if(i(t.histogram)&&("number"===typeof t.histogram.min&&(e.minimum=t.histogram.min),"number"===typeof t.histogram.max&&(e.maximum=t.histogram.max),n(e)))return e}let r=this.getMetadata("classification:classes");if(Array.isArray(r)&&(r.reduce(((t,e)=>(t.minimum=Math.min(t.minimum,e.value),t.maximum=Math.max(t.maximum,e.value),t)),e),n(e)))return e;let s=this.getMetadata("file:values");if(Array.isArray(s)&&(s.reduce(((t,e)=>(t.minimum=Math.min(t.minimum,...e.values),t.maximum=Math.max(t.maximum,...e.values),t)),e),n(e)))return e;let l=i(t)&&t.data_type||this.getMetadata("file:data_type");return l&&(e.minimum=a(l),e.maximum=u(l)),e}getNoDataValues(t=null){t=this.getBand(t);let e=[];if(t&&"undefined"!==typeof t.nodata)e.push(t.nodata);else{let t=this.getMetadata("file:nodata");if("undefined"!==typeof t)e=t;else{let t=this.getMetadata("classification:classes");Array.isArray(t)&&(e=t.filter((t=>Boolean(t.nodata))).map((t=>t.value)))}}return e.map((t=>"nan"===t?NaN:"+inf"===t?1/0:"-inf"===t?-1/0:t))}isDefintion(){return!s(this.href)}isHTTP(){return this.isDefintion()?null:super.isHTTP()}hasRole(t,e=!1){return Array.isArray(t)||(t=[t]),!(!e||!t.includes(this.getKey()))||Array.isArray(this.roles)&&Boolean(this.roles.find((e=>t.includes(e))))}static fromAssets(t,e=null){let n={};if(i(t))for(let r in t)n[r]=new R(t[r],r,e);return n}}var W=R;class j extends C{constructor(t,e=null,n={},r=[]){super(t,e,n,r)}getTemporalExtent(){return null}getTemporalExtents(){return[]}getIcons(t=!0){return this.getLinksWithRels(["icon"]).filter((e=>e.canBrowserDisplayImage(t)))}getThumbnails(t=!0,e=null){let n=this.getAssetsWithRoles(["thumbnail","overview"],!0);return e&&n.length>1&&n.sort((t=>Array.isArray(t.roles)&&t.roles.includes(e)||t.getKey()===e?-1:1)),0===n.length&&(n=this.getLinksWithRels(["preview"])),t&&(n=n.filter((t=>t.canBrowserDisplayImage()))),n}getDefaultGeoTIFF(t=!0,e=!1){let n=this.rankGeoTIFFs(t,e);return n[0]?.asset}rankGeoTIFFs(t=!0,e=!1,n=null,r=null){i(n)||(n={data:1,visual:2,thumbnail:2,overview:3});let s=[],l=this.getAssetsByTypes(b);t&&(l=l.filter((t=>t.isHTTP()&&(!e||t.isCOG()))));let a=Object.entries(n);for(let i of l){let t=0;if(a.length>0){let e=a.filter((([t])=>i.hasRole(t,!0))).map((([,t])=>t));e.length>0&&(t+=Math.max(...e))}!e&&i.isCOG()&&(t+=2),i.findVisualBands()&&(t+=1),"function"===typeof r&&(t+=r(i)),s.push({asset:i,score:t})}return s.sort(((t,e)=>e.score-t.score)),s}findVisualAssets(){let t={red:null,green:null,blue:null},e=Object.keys(t),n=this.getAssets();for(let s of n){let n=s.getBands();if(1!==n.length)continue;let r=s.findBand(e,"common_name",n);r&&(t[r.band.common_name]=s)}let r=Object.values(t).every((t=>null!==t));return r?t:null}getAsset(t){return i(this.assets)&&this.assets[t]||null}getAssets(){return i(this.assets)?Object.values(this.assets):[]}getAssetsWithRoles(t,e=!1){return this.getAssets().filter((n=>n.hasRole(t,e)))}getAssetWithRole(t,e=!1){let n=this.getAssetsWithRoles([t],e);return n[0]||null}getAssetsByTypes(t){return this.getAssets().filter((e=>B(e.type,t)))}equals(t){return this===t||t instanceof j&&(this.getObjectType()===t.getObjectType()&&!(!this.id||this.id!==t.id))}}var M=j;class E extends M{constructor(t,e=null,n={},r=[]){super(t,e,n,r)}getObjectType(){return this.type}getSearchLink(t=null){let e=this.getStacLinksWithRel("search");return t?e[0]||null:e.find((e=>e.method===t||!t&&!e.method))||null}getApiCollectionsLink(){return this.getStacLinkWithRel("data")}getApiItemsLink(){return this.getStacLinkWithRel("items")}getChildLinks(){return this.getStacLinksWithRel("child")}getItemLinks(){return this.getStacLinksWithRel("item")}}var I=E;class D extends I{constructor(t,e=null){super(t,e)}}var F=D;function G(t){if(s(t)&&t.length>=10)try{let e=t.match(/^(-?\d{1,})-(\d\d)-(\d\d)[T ](\d\d):(\d\d):(\d\d)(?:\.(\d*))?(?:Z|[+-]00:00)?$/i),n=e.slice(1).map((t=>parseInt(t,10)));return new Date(Date.UTC(n[0],n[1]-1,n[2],n[3],n[4],n[5],n[6]||0))}catch(e){return null}return null}function N(t,e){return new Date(t.valueOf()+(e-t)/2)}function J(t){if(!Array.isArray(t)||0===t.length)return null;let e,n;const r=(t,e,n)=>"undefined"===typeof t?e:null===t||null===e?null:n(t,e);return t.forEach((([t,s])=>{e=r(e,t,Math.min),n=r(n,s,Math.max)})),[null===e?null:new Date(e),null===n?null:new Date(n)]}function U(t){let e=t.length>4,n=t[0],r=t[e?3:2],s=t[1],i=t[e?4:3];return{west:n,east:r,south:s,north:i}}function P(t){let{west:e,east:n,south:r,north:s}=U(t);return[[[e,s],[e,r],[n,r],[n,s],[e,s]]]}function K(t){if(V(t)?t=[t]:Array.isArray(t)&&(t=t.filter((t=>V(t)))),!Array.isArray(t)||0===t.length)return null;let e=t.reduce(((t,e)=>{if(H(e)){let{west:n,east:r,south:s,north:i}=U(e);t.push(P([-180,s,r,i])),t.push(P([n,s,180,i]))}else t.push(P(e));return t}),[]),n=null;return 1===e.length?n={type:"Polygon",coordinates:e[0]}:e.length>1&&(n={type:"MultiPolygon",coordinates:e}),n?{type:"Feature",geometry:n,properties:{}}:void 0}function V(t){if(!Array.isArray(t)||![4,6].includes(t.length)||t.some((t=>"number"!==typeof t)))return!1;let{west:e,east:n,south:r,north:s}=U(t);return r<=s&&e>=-180&&e<=180&&r>=-90&&n<=180&&n>=-180&&s<=90}function H(t){if(!V(t))return!1;let{west:e,east:n}=U(t);return e>n}function z(t){if(!Array.isArray(t)||0===t.length)return null;let e={west:180,south:90,east:-180,north:-90};t.forEach((t=>{if(!V(t))return;let n=U(t),r=["west","south"];for(let s in n){let t=r.includes(s)?Math.min:Math.max;e[s]=t(e[s],n[s])}}));let n=[e.west,e.south,e.east,e.north];return V(n)?n:null}class q extends I{constructor(t,e=null){const n={assets:W.fromAssets,item_assets:W.fromAssets};super(t,e,n)}toGeoJSON(){let t=K(this.getBoundingBoxes());return t&&(t.id=this.id),t}getBoundingBox(){let t=this.getRawBoundingBoxes();return t.length>0&&V(t[0])?t[0]:null}getBoundingBoxes(){let t=this.getRawBoundingBoxes();return 1===t.length&&V(t[0])?t:t.length>1?t.filter(((t,e)=>e>0&&V(t))):[]}getRawBoundingBoxes(){let t=this.extent?.spatial?.bbox;return Array.isArray(t)&&t.length>0?t:[]}getTemporalExtent(){return this.getTemporalExtents()[0]||null}getTemporalExtents(){let t=this.extent?.temporal?.interval;return Array.isArray(t)&&t.length>0?t.filter((t=>Array.isArray(t)&&(s(t[0])||s(t[1])))).map((t=>t.map((t=>G(t))))):[]}getSummary(t){return this.summaries[t]}getBands(){let t=this.getSummary("eo:bands"),e=this.getSummary("raster:bands"),n=[t,e].filter((t=>Array.isArray(t)));return n.length>=2?l(...n):1===n.length?n[0]:[]}}var Z=q;class $ extends S{constructor(t,e=null){const n={collections:t=>t.map((t=>new Z(t)))};super(t,e,n)}getObjectType(){return"CollectionCollection"}getAll(){return this.collections}isCollectionCollection(){return!0}toGeoJSON(){let t=this.collections.map((t=>t.toGeoJSON())).filter((t=>null!==t));return{type:"FeatureCollection",features:t}}getBoundingBox(){return z(this.getBoundingBoxes())}getBoundingBoxes(){return this.collections.map((t=>t.getBoundingBox()))}getTemporalExtent(){return J(this.getTemporalExtents())}getTemporalExtents(){return this.collections.map((t=>t.getTemporalExtent()))}}var Q=$;class X extends M{constructor(t,e=null){super(t,e,{assets:W.fromAssets})}getObjectType(){return"Item"}toGeoJSON(){return this.toJSON()}getBoundingBox(){return V(this.bbox)?this.bbox:null}getBoundingBoxes(){return V(this.bbox)?[this.bbox]:[]}getDateTime(){let t=G(this.properties.datetime);if(!t){let t=G(this.properties.start_datetime),e=G(this.properties.end_datetime);return t&&e?N(t,e):t||e}return t}getTemporalExtent(){return this.getTemporalExtents()[0]||null}getTemporalExtents(){let t=[];return s(this.properties.start_datetime)||s(this.properties.end_datetime)?t=[[this.properties.start_datetime||null,this.properties.end_datetime||null]]:s(this.properties.datetime)&&(t=[[this.properties.datetime,this.properties.datetime]]),t.map((t=>t.map((t=>G(t)))))}getMetadata(t){return this.properties[t]}getBands(){let t=this.getMetadata("eo:bands");return Array.isArray(t)?t:[]}getCollectionLink(){return this.getStacLinkWithRel("collection")}}var Y=X;class tt extends S{constructor(t,e=null){const n={features:t=>t.map((t=>new Y(t)))};super(t,e,n)}getObjectType(){return"ItemCollection"}getAll(){return this.features}toGeoJSON(){return this.toJSON()}getBoundingBox(){return z(this.getBoundingBoxes())}getBoundingBoxes(){return this.features.map((t=>t.getBoundingBox()))}getTemporalExtent(){return J(this.getTemporalExtents())}getTemporalExtents(){return this.features.map((t=>t.getTemporalExtent()))}}var et=tt;function nt(t,e=!0,n=!1){return e&&(t=r.stac(t,n)),"Feature"===t.type?new Y(t):"FeatureCollection"===t.type?new et(t):"Collection"===t.type||!t.type&&"undefined"!==typeof t.extent&&"undefined"!==typeof t.license?new Z(t):!t.type&&Array.isArray(t.collections)?new Q(t):new F(t)}}}]);
//# sourceMappingURL=5833.dc6d2d67.js.map